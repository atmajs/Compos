(function(t){var e={calId:0,cssName:"default",startDate:-1,endDate:-1,selectedDate:-1,showPrevNext:!0,allowOld:!0,showAlways:!1,position:"absolute"},a={init:function(s){return this.each(function(){var d=t(this),n=t.extend({},e);n.calId=d[0].id+"-gldp",s&&(n=t.extend(n,s)),d.data("settings",n),d.click(a.show).focus(a.show),n.showAlways&&setTimeout(function(){d.trigger("focus")},50),t(document).bind("click.picker",function(){a.hide.apply(d)})})},show:function(e){e.stopPropagation(),a.hide.apply(t("._gldp").not(t(this))),a.update.apply(t(this))},hide:function(){if(t(this).length){var e=t(this).data("settings");e.showAlways||(t("#"+e.calId).slideUp(200),t(this).removeClass("_gldp"))}},setStartDate:function(e){t(this).data("settings").startDate=e},setEndDate:function(e){t(this).data("settings").endDate=e},setSelectedDate:function(e){t(this).data("settings").selectedDate=e},remove:function(){t(document).unbind("click.picker")},update:function(){var e=t(this),s=e.data("settings"),d=s.calId,n=s.startDate;-1==s.startDate&&(n=new Date,n.setDate(1)),n.setHours(0,0,0,0);var i=n.getTime(),o=new Date(0);-1!=s.endDate&&(o=new Date(s.endDate),/^\d+$/.test(s.endDate)&&(o=new Date(n),o.setDate(o.getDate()+s.endDate))),o.setHours(0,0,0,0);var l=o.getTime(),r=new Date(0);-1!=s.selectedDate&&(r=new Date(s.selectedDate),/^\d+$/.test(s.selectedDate)&&(r=new Date(n),r.setDate(r.getDate()+s.selectedDate))),r.setHours(0,0,0,0);var c=r.getTime(),h=e.data("theDate");h=-1==h||void 0===h?n:h;var D=new Date(h);D.setDate(1);var u=D.getTime(),g=new Date(D);g.setMonth(g.getMonth()+1),g.setDate(0);var p=g.getTime(),v=g.getDate(),f=new Date(D);f.setDate(0),f=f.getDate();var w=["January","February","March","April","May","June","July","August","September","October","November","December"];e.data("theDate",h);for(var y="",m=0,M=0;6>m;m++){for(var b="",x=0;7>x;x++,M++){var C=f-D.getDay()+M+1,T=C-f,k=0==x?"sun":6==x?"sat":"day";if(T>=1&&v>=T){var N=new Date;N.setHours(0,0,0,0);var P=new Date(h);P.setHours(0,0,0,0),P.setDate(T);var A=P.getTime();k=N.getTime()==A?"today":k,s.allowOld||(k=i>A?"noday":k),-1!=s.endDate&&(k=A>l?"noday":k),-1!=s.selectedDate&&(k=A==c?"selected":k)}else k="noday",T=0>=T?C:C-v-f;b+="<td class='gldp-days "+k+" **-"+k+"'><div class='"+k+"'>"+T+"</div></td>"}y+="<tr class='days'>"+b+"</tr>"}var H=u>i||s.allowOld,I=l>p||i>l;s.showPrevNext||(H=I=!1);var S=w[h.getMonth()]+" "+h.getFullYear(),F="<div class='**'><table><tr>"+("<td class='**-prevnext prev'>"+(H?"◄":"")+"</td>")+"<td class='**-monyear' colspan='5'>{MY}</td>"+("<td class='**-prevnext next'>"+(I?"►":"")+"</td>")+"</tr>"+"<tr class='**-dow'>"+"<td>Sun</td><td>Mon</td><td>Tue</td><td>Wed</td><td>Thu</td><td>Fri</td><td>Sat</td>"+"</tr>"+y+"</table>"+"</div>";F=F.replace(/\*{2}/gi,"gldp-"+s.cssName).replace(/\{MY\}/gi,S),0==t("#"+d).length&&e.after(t("<div id='"+d+"'></div>").css({position:s.position,"z-index":s.zIndex,left:e.offset().left,top:e.offset().top+e.outerHeight(!0)}));var O=t("#"+d);O.html(F).slideDown(200),e.addClass("_gldp"),t("[class*=-prevnext]",O).click(function(s){if(s.stopPropagation(),""!=t(this).html()){var d=t(this).hasClass("prev")?-1:1,n=new Date(D);n.setMonth(h.getMonth()+d),e.data("theDate",n),a.update.apply(e)}}),t("tr.days td:not(.noday, .selected)",O).mouseenter(function(){var e="gldp-"+s.cssName+"-"+t(this).children("div").attr("class");t(this).removeClass(e).addClass(e+"-hover")}).mouseleave(function(){if(!t(this).hasClass("selected")){var e="gldp-"+s.cssName+"-"+t(this).children("div").attr("class");t(this).removeClass(e+"-hover").addClass(e)}}).click(function(s){s.stopPropagation();var d=t(this).children("div").html(),n=e.data("settings"),i=new Date(h);i.setDate(d),e.data("theDate",i),e.val(i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()),null!=n.onChange&&void 0!==n.onChange&&n.onChange(e,i),n.selectedDate=i,a.hide.apply(e)})}};t.fn.glDatePicker=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.glDatePicker"),void 0):a.init.apply(this,arguments)}})(jQuery);